### DOM 的缺陷

当我们调用document.body.appendChild(node) 往 body 节点上添加一个元素，调用该 API 之后会引发一系列的连锁反应。渲染引擎会将 node 节点添加到 body 节点知识，然后触发样式计算、布局、绘制、栅格化、合成等任务，称之为重排。

另外对于 DOM 的不当操作还有可能引发强制同步布局和布局抖动的问题，降低渲染效率。

### 什么是虚拟 DOM

虚拟DOM到底要做哪些事？

- 将页面改变的内容应用到虚拟 DOM 上，而不是直接应用到 DOM 上。
- 变化被应用到虚拟 DOM 上时，虚拟 DOM 并不急着去渲染页面，而仅仅是调整虚拟 DOM 的内部状态，这样操作虚拟 DOM 的代价就变得非常轻了。
- 在虚拟 DOM 收集到足够的改变时，再把这些变化一次性应用到真实的 DOM 上。

怎么运行的？

- **创建阶段**。首先依据 JSX 和基础数据创建出来虚拟 DOM，它反映了真实的 DOM 树的结构。然后由虚拟 DOM 树创建出真实 DOM 树，真实的 DOM 树生成完后，再触发渲染流水线往屏幕输出页面。
- **更新阶段**。如果数据发生了改变，那么就需要根据新的数据创建一个新的虚拟 DOM 树；然后 React 比较两个树，找出变化的地方，并把变化的地方一次性更新到真实的 DOM 树上；最后渲染引擎更新渲染流水线，并生成新的页面。

### MVC 模式

MVC 模式 能将数据和视图进行分离，在涉及到一些复杂的项目时，能够大大减轻项目的耦合度，使得程序易于维护。

![MVC 基础结构](E:\Blog\docs\.vuepress\public\MVC.png)

MVC 整体结构由模型 - 视图 - 控制器 组成，核心思想就是将数据和视图分离。

基于 MVC 又能衍生出很多其他的模式，如 MVP、MVVM 等，不过万变不离其宗，它们的基础骨架都是基于 MVC 而来。