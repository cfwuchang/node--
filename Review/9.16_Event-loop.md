##  **EventLoop**

### JavaScript的执行原理

- JavaScript是单线程，同一时间只能做一件事情。

  （为什么是单线程 ？ js主要用途是用户交互，操作dom，多线程容易带来同步问题。）

  **所有的任务**需要排队，前一个任务结束，才会执行后一个任务。

- 为了防止执行阻塞 （数据请求 settimeout)，故有了同步任务和异步任务。

  **同步任务**：在主线程上排队执行，只有前一个任务执行完毕，才执行后一个任务。 形成执行栈

  **异步任务** ：不进入主线程，而是进入 任务队列 里面。只要某个异步任务有了结果，就放到任务队列里面。 

  

  所有同步任务都在主进程上执行，形成执行栈。另外还有一个任务队列，一旦执行栈中的所有同步任务被清空，就会读取任务队列里面的异步任务进入执行栈，开始执行。
  
  

上面是从任务调度的角度的Eventloop，从js另一个角度的话，可以分为宏任务和微任务。

**宏任务**主要为用户的一些交互事件，渲染事件，包括 整体代码script(js脚本执行)，setTimeout，setInterval，I/O，render

**微任务**主要为 promise相关的  以及基于promise开发的技术，包括 Promise.then，node端的process.nextTrick，Async/Await。

事件循环流程：
	1.先将整体代码作为一个宏任务执行，进入主线程。

      	2. 中途遇到同步或者立即执行的代码直接执行 ，遇到微任务加入微任务队列, 遇到宏任务，加入宏任务队列。
      	3. 整体代码执行到底的时候，再读取本轮的微任务全部执行完，在读取宏任务进行下一轮执行。
      	4. 微任务中又产生了微任务，继续执行微任务，直到本轮中所有微任务执行完毕。
      	5. 只要宏任务队列不为空，就从宏任务队列里取出一个执行，把微任务队列取出所有执行。




