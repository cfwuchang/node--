<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
<script>
  function onResponse(posts) {
    // 定义对数据的操作
    console.log(posts, '手动插入script');
  }
  // 前端定义函数 没有调用
</script>

// 后端调用
// 请求完毕得到的内容是 字符串形式的 函数名（参数）
// script的标签的原因，浏览器会把这一段字符串当作js执行
// 相当于前端预先定义好的回调执行
// ?callback=onResponse
<!-- <script src='http://localhost:9090'></script> -->
<!-- <script>
  // 相当于返回=》
  onResponse(["js","react"])
</script> -->


<script> 
function jsonp(url, options){
  return new Promise((resolve, reject)=> {
     let funcName = `jsonp${Date.now()}`;
     // 在全局上面定义一个回调函数
     window[funcName] = function (data) {
       resolve(data)
     }
     const scriptNode = document.createElement('script');
     scriptNode.src = `${url}?callback=${funcName}`
     document.body.appendChild(scriptNode);
     scriptNode.onerror = function (err) {
       reject(err)
     }
  })
}

jsonp('http://localhost:9090/api', {
  callback: 'rest1',
})
.then(res => {
  console.log(res,'jsonp')
})
.catch(res => {
  console.log(res)
})
</script>
</body>
</html>